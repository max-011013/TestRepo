import json
import pandas as pd
from bson.objectid import ObjectId

import pymongo
#parentAccount = ["WALMART_M", "CROCS_M", "FERGUSON_M","DAMCO_M","FUJITSU_M"]
parentAccount = ["SCHNEIDER_M","URBAN OUTFITTERS_M","VALARIS_M","WILLIAMS SONOMA_M","YOKOHAMA_M"]


def db_connection(connectionString):
    try:
        client = pymongo.MongoClient(connectionString)
        database = client['T5-invoize-uat']
        return database
    except:
        return None
    
def createAirProfile(db,acc):
    try:
        shipmentcoll = db["ceva20150519134235Template"]
        accountColl = db["Account"]
        air = pd.read_csv("AirProfile.csv")
        #air.to_json(orient="records")
        air.to_json("_result.json", orient="records")
        with open("_result.json", 'r') as jsonfile:
            data = json.loads(jsonfile.read())

        #with open("airProfile.json", 'r') as jsonfile:
        #    airShipmentData = json.loads(jsonfile.read())
        parent = accountColl.find_one({"accountNumber":acc},{"_id":1})

        airShipmentData = {
            "profileBased" : {
                "ServiceType" : {
                    "profileBased" : True,
                    "key" : "ServiceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Service Type",
                    "isMasterField" : False,
                    "displayOrder" : 588,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_AMATServiceType",
                    "errorMessage" : "",
                    "groupCaption" : "SHIPMENT INFORMATION",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "fpcName" : {
                    "profileBased" : True,
                    "isDocUPload" : None,
                    "key" : "fpcName",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "useForCustomReport" : None,
                    "tariffIdentifier" : None,
                    "isMultiple" : None,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "FPC name",
                    "isMasterField" : None,
                    "displayOrder" : 447,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionsSource" : "metadata_businessUnit",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : None,
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : None,
                    "value" : None,
                    "length" : 10,
                    "customFlag" : None
                },
                "destinationStationCode" : {
                    "profileBased" : True,
                    "key" : "destinationStationCode",
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "label" : "Destination Station Code",
                    "isMasterField" : True,
                    "displayOrder" : 102,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Destination Station Code",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 35,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#serviceType" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#serviceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Service Type",
                    "displayOrder" : 540,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_ToshibaVeractionServiceTypes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "businessUnit" : {
                    "profileBased" : True,
                    "key" : "businessUnit",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "tariffIdentifier" : None,
                    "isMultiple" : None,
                    "regex" : None,
                    "groupKey" : "references",
                    "label" : "Business Unit",
                    "isMasterField" : None,
                    "displayOrder" : 176,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : "businessUnit",
                    "suggestionsSource" : "metadata_TYCOBusinessUnits",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : "Business Unit",
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "value" : None,
                    "length" : 200,
                    "customFlag" : None
                },
                "OriginAirportCode" : {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "fieldValidation" : "",
                    "label" : "Origin Airport Code",
                    "isMasterField" : False,
                    "displayOrder" : 86,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Airport Code",
                    "isDependent" : False,
                    "key" : "OriginAirportCode",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 3,
                    "customFlag" : False
                },
                "transportMode" : {
                    "profileBased" : True,
                    "key" : "transportMode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : True,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Transport Mode",
                    "isMasterField" : False,
                    "displayOrder" : 6,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "metadata_transportModes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Transport Mode",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "serviceType" : {
                    "profileBased" : True,
                    "key" : "serviceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Service Type",
                    "isMasterField" : False,
                    "displayOrder" : 126,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "metadata_serviceTypes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "serviceLevel" : {
                    "profileBased" : True,
                    "key" : "serviceLevel",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Service Level",
                    "isMasterField" : False,
                    "displayOrder" : 127,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "metadata_serviceLevels",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Level",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "originStationCode" : {
                    "profileBased" : True,
                    "key" : "originStationCode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "label" : "Origin Station Code",
                    "isMasterField" : True,
                    "displayOrder" : 79,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Station Code",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 35,
                    "customFlag" : False
                },
                "shipmentType" : {
                    "profileBased" : True,
                    "key" : "shipmentType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Shipment Type",
                    "isMasterField" : False,
                    "displayOrder" : 5,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "shipmentType",
                    "suggestionsSource" : "metadata_shipmentTypes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Shipment Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "billToPartyPartyAccountNumber" : {
                    "profileBased" : True,
                    "key" : "billToPartyPartyAccountNumber",
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "invoice",
                    "label" : "Bill To Account Number",
                    "isMasterField" : True,
                    "displayOrder" : 51,
                    "type" : "text",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "account",
                    "errorMessage" : "",
                    "groupCaption" : "Invoice",
                    "toolTip" : "Bill To Account Number",
                    "isDependent" : False,
                    "isUniqueField" : True,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : None,
                    "length" : 25,
                    "customFlag" : False
                },
                "references#references#businessUnit" : {
                    "profileBased" : True,
                    "key" : "references#references#businessUnit",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "label" : "Business Unit",
                    "displayOrder" : 547,
                    "regex" : None,
                    "groupKey" : "references",
                    "fieldValidation" : "",
                    "tariffIdentifier" : None,
                    "isMasterField" : None,
                    "isMultiple" : None,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : "businessUnit",
                    "suggestionsSource" : "metadata_TYCOBusinessUnits",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : "Business Unit",
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 200,
                    "customFlag" : None
                },
                "mode" : {
                    "profileBased" : True,
                    "key" : "mode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "invoice.delivered",
                    "label" : "Delivery Mode",
                    "isMasterField" : False,
                    "displayOrder" : 262,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "invoiceDeliveryMode",
                    "suggestionsSource" : "metadata_deliveryMode",
                    "errorMessage" : None,
                    "groupCaption" : "Delivery",
                    "toolTip" : "Mode",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 25,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#serviceLevel" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#serviceLevel",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Service Level",
                    "displayOrder" : 541,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "servicelevelcode",
                    "suggestionsSource" : "metadata_ToshibaVeractionServiceLevels",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Level",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#transportMode" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#transportMode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Transport Mode",
                    "displayOrder" : 508,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : True,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "transportMode",
                    "suggestionsSource" : "metadata_transportModes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Transport Mode",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : [
                        {
                            "id" : "555b112989025b2b58759f7e",
                            "v" : "Air",
                            "n" : "Air"
                        }
                    ],
                    "length" : 20,
                    "customFlag" : False
                }
            },
            "templateId": ObjectId("5649d0ce087df204a8a71637"),
            "docType": "shipment",
            "isDefault" : False,
            "systemId": ObjectId("5649d0ce087df204a8a71638"),
            "template" : {
                "ServiceType" : {
                    "profileBased" : True,
                    "key" : "ServiceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Service Type",
                    "isMasterField" : False,
                    "displayOrder" : 588,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_AMATServiceType",
                    "errorMessage" : "",
                    "groupCaption" : "SHIPMENT INFORMATION",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "fpcName" : {
                    "profileBased" : True,
                    "isDocUPload" : None,
                    "key" : "fpcName",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "useForCustomReport" : None,
                    "tariffIdentifier" : None,
                    "isMultiple" : None,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "FPC name",
                    "isMasterField" : None,
                    "displayOrder" : 447,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionsSource" : "metadata_businessUnit",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : None,
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : None,
                    "value" : None,
                    "length" : 10,
                    "customFlag" : None
                },
                "destinationStationCode" : {
                    "profileBased" : True,
                    "key" : "destinationStationCode",
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "label" : "Destination Station Code",
                    "isMasterField" : True,
                    "displayOrder" : 102,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Destination Station Code",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 35,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#serviceType" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#serviceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Service Type",
                    "displayOrder" : 540,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_ToshibaVeractionServiceTypes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "businessUnit" : {
                    "profileBased" : True,
                    "key" : "businessUnit",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "tariffIdentifier" : None,
                    "isMultiple" : None,
                    "regex" : None,
                    "groupKey" : "references",
                    "label" : "Business Unit",
                    "isMasterField" : None,
                    "displayOrder" : 176,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : "businessUnit",
                    "suggestionsSource" : "metadata_TYCOBusinessUnits",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : "Business Unit",
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "value" : None,
                    "length" : 200,
                    "customFlag" : None
                },
                "OriginAirportCode" : {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "fieldValidation" : "",
                    "label" : "Origin Airport Code",
                    "isMasterField" : False,
                    "displayOrder" : 86,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Airport Code",
                    "isDependent" : False,
                    "key" : "OriginAirportCode",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 3,
                    "customFlag" : False
                },
                "originStationCode" : {
                    "profileBased" : True,
                    "key" : "originStationCode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "label" : "Origin Station Code",
                    "isMasterField" : True,
                    "displayOrder" : 79,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Station Code",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 35,
                    "customFlag" : False
                },
                "shipmentType" : {
                    "profileBased" : True,
                    "key" : "shipmentType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Shipment Type",
                    "isMasterField" : False,
                    "displayOrder" : 5,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "shipmentType",
                    "suggestionsSource" : "metadata_shipmentTypes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Shipment Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "billToPartyPartyAccountNumber" : {
                    "profileBased" : True,
                    "key" : "billToPartyPartyAccountNumber",
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "invoice",
                    "label" : "Bill To Account Number",
                    "isMasterField" : True,
                    "displayOrder" : 51,
                    "type" : "text",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "account",
                    "errorMessage" : "",
                    "groupCaption" : "Invoice",
                    "toolTip" : "Bill To Account Number",
                    "isDependent" : False,
                    "isUniqueField" : True,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : None,
                    "length" : 25,
                    "customFlag" : False
                },
                "references#references#businessUnit" : {
                    "profileBased" : True,
                    "key" : "references#references#businessUnit",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "label" : "Business Unit",
                    "displayOrder" : 547,
                    "regex" : None,
                    "groupKey" : "references",
                    "fieldValidation" : "",
                    "tariffIdentifier" : None,
                    "isMasterField" : None,
                    "isMultiple" : None,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : "businessUnit",
                    "suggestionsSource" : "metadata_TYCOBusinessUnits",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : "Business Unit",
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 200,
                    "customFlag" : None
                },
                "mode" : {
                    "profileBased" : True,
                    "key" : "mode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "invoice.delivered",
                    "label" : "Delivery Mode",
                    "isMasterField" : False,
                    "displayOrder" : 262,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "invoiceDeliveryMode",
                    "suggestionsSource" : "metadata_deliveryMode",
                    "errorMessage" : None,
                    "groupCaption" : "Delivery",
                    "toolTip" : "Mode",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 25,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#serviceLevel" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#serviceLevel",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Service Level",
                    "displayOrder" : 541,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "servicelevelcode",
                    "suggestionsSource" : "metadata_ToshibaVeractionServiceLevels",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Level",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#transportMode" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#transportMode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Transport Mode",
                    "displayOrder" : 508,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : True,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "transportMode",
                    "suggestionsSource" : "metadata_transportModes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Transport Mode",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : [
                        {
                            "id" : "555b112989025b2b58759f7e",
                            "v" : "Air",
                            "n" : "Air"
                        }
                    ],
                    "length" : 20,
                    "customFlag" : False
                }
            },
            "affectAccounts": True,
            "accountId" : parent["_id"],
            "addedBy" : "invoizeAutomation"
    
        }


        fields = []

        for rec in data:
            air_field_json={
            "profileBased": False,
            "isDocUPload": True,
            "isReadonly": False,
            "tariffIdentifier": False,
            "useForCustomReport" : True,
            "regex": None,
            "groupKey": rec["Group Key"],
            "label": rec["Data Fields"],
            "displayOrder": rec["Display Order"],
            "type": rec["Field Type"],
            "isDefault": False,
            "validationActive": True,
            "description": None,
            "suggestionsSource": rec["Suggestion Source"],
            "suggestionField": rec["Suggestion field"],
            "errorMessage": "",
            "groupCaption": rec["Group Caption"],
            "toolTip": rec["Data Fields"],
            "isDependent": False,
            "key": rec["Field Key"],
            "addInAccessSet": False,
            "isActive": True,
            "length": rec["Max Length"],
            "customFlag": False
            }
            if rec["Mandatory"]=="Yes":
                air_field_json["isMandatory"] = True
            else:
                air_field_json["isMandatory"] = False
            if rec["Is Master Field"]=="Yes":
                air_field_json["isMasterField"] = True
            else:
                air_field_json["isMasterField"] = False

            if rec["Multiple field"]=="Yes":
                air_field_json["isMultiple"] = True
            else:
                air_field_json["isMultiple"] = False

            if rec["is Unique Field"]=="Yes":
                air_field_json["isUniqueField"] = True
            else:
                air_field_json["isUniqueField"] = False

            if rec["Data Fields"] == "View Document":
                air_field_json["validationActive"]= False
                air_field_json["useForCustomReport"]= None
            if rec["Is System unique field"]=="Yes":
                air_field_json["isSystemUniqueField"] = True
            else:
                air_field_json["isSystemUniqueField"] = False
            
            fields.append(air_field_json)
        airShipmentData["fields"] = fields
        airShipmentData["profileName"]= acc+" AIR"
        


        shipmentcoll.insert_one(airShipmentData)
        #print(airShipmentData)

        shipment = shipmentcoll.find_one({"profileName":acc+" AIR"},{"_id":1})
        accountColl.update_one({"_id" : parent["_id"]},{
            "$push" : {
            "references.shipmentProfile": shipment["_id"]
            }
        })
    except Exception as err:
        print(err)
    
def createOceanProfile(db,acc):
    try:
        shipmentcoll = db["ceva20150519134235Template"]
        accountColl = db["Account"]
        ocean = pd.read_csv("OceanProfile.csv")
        #ocean.to_json(orient="records")
        ocean.to_json("_result2.json", orient="records")
        with open("_result2.json", 'r') as jsonfile:
            data = json.loads(jsonfile.read())
        
        
        #with open("oceanProfile.json", 'r') as jsonfile:
        #    oceanShipmentData = json.loads(jsonfile.read())
        
        parent = accountColl.find_one({"accountNumber":acc},{"_id":1})
        oceanShipmentData = {
            "profileBased" : {
                "ServiceType" : {
                    "profileBased" : True,
                    "key" : "ServiceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Service Type",
                    "isMasterField" : False,
                    "displayOrder" : 588,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_AMATServiceType",
                    "errorMessage" : "",
                    "groupCaption" : "SHIPMENT INFORMATION",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "fpcName" : {
                    "profileBased" : True,
                    "isDocUPload" : None,
                    "key" : "fpcName",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "useForCustomReport" : None,
                    "tariffIdentifier" : None,
                    "isMultiple" : None,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "FPC name",
                    "isMasterField" : None,
                    "displayOrder" : 447,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionsSource" : "metadata_businessUnit",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : None,
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : None,
                    "value" : None,
                    "length" : 10,
                    "customFlag" : None
                },
                "destinationStationCode" : {
                    "profileBased" : True,
                    "key" : "destinationStationCode",
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "label" : "Destination Station Code",
                    "isMasterField" : True,
                    "displayOrder" : 102,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Destination Station Code",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 35,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#serviceType" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#serviceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Service Type",
                    "displayOrder" : 540,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_ToshibaVeractionServiceTypes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "businessUnit" : {
                    "profileBased" : True,
                    "key" : "businessUnit",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "tariffIdentifier" : None,
                    "isMultiple" : None,
                    "regex" : None,
                    "groupKey" : "references",
                    "label" : "Business Unit",
                    "isMasterField" : None,
                    "displayOrder" : 176,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : "businessUnit",
                    "suggestionsSource" : "metadata_TYCOBusinessUnits",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : "Business Unit",
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "value" : None,
                    "length" : 200,
                    "customFlag" : None
                },
                "OriginAirportCode" : {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "fieldValidation" : "",
                    "label" : "Origin Airport Code",
                    "isMasterField" : False,
                    "displayOrder" : 86,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Airport Code",
                    "isDependent" : False,
                    "key" : "OriginAirportCode",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 3,
                    "customFlag" : False
                },
                "transportMode" : {
                    "profileBased" : True,
                    "key" : "transportMode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : True,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Transport Mode",
                    "isMasterField" : False,
                    "displayOrder" : 6,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "metadata_transportModes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Transport Mode",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "serviceType" : {
                    "profileBased" : True,
                    "key" : "serviceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Service Type",
                    "isMasterField" : False,
                    "displayOrder" : 126,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "metadata_serviceTypes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "serviceLevel" : {
                    "profileBased" : True,
                    "key" : "serviceLevel",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Service Level",
                    "isMasterField" : False,
                    "displayOrder" : 127,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "metadata_serviceLevels",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Level",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "originStationCode" : {
                    "profileBased" : True,
                    "key" : "originStationCode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "label" : "Origin Station Code",
                    "isMasterField" : True,
                    "displayOrder" : 79,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Station Code",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 35,
                    "customFlag" : False
                },
                "shipmentType" : {
                    "profileBased" : True,
                    "key" : "shipmentType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Shipment Type",
                    "isMasterField" : False,
                    "displayOrder" : 5,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "shipmentType",
                    "suggestionsSource" : "metadata_shipmentTypes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Shipment Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "billToPartyPartyAccountNumber" : {
                    "profileBased" : True,
                    "key" : "billToPartyPartyAccountNumber",
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "invoice",
                    "label" : "Bill To Account Number",
                    "isMasterField" : True,
                    "displayOrder" : 51,
                    "type" : "text",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "account",
                    "errorMessage" : "",
                    "groupCaption" : "Invoice",
                    "toolTip" : "Bill To Account Number",
                    "isDependent" : False,
                    "isUniqueField" : True,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : None,
                    "length" : 25,
                    "customFlag" : False
                },
                "references#references#businessUnit" : {
                    "profileBased" : True,
                    "key" : "references#references#businessUnit",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "label" : "Business Unit",
                    "displayOrder" : 547,
                    "regex" : None,
                    "groupKey" : "references",
                    "fieldValidation" : "",
                    "tariffIdentifier" : None,
                    "isMasterField" : None,
                    "isMultiple" : None,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : "businessUnit",
                    "suggestionsSource" : "metadata_TYCOBusinessUnits",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : "Business Unit",
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 200,
                    "customFlag" : None
                },
                "mode" : {
                    "profileBased" : True,
                    "key" : "mode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "invoice.delivered",
                    "label" : "Delivery Mode",
                    "isMasterField" : False,
                    "displayOrder" : 262,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "invoiceDeliveryMode",
                    "suggestionsSource" : "metadata_deliveryMode",
                    "errorMessage" : None,
                    "groupCaption" : "Delivery",
                    "toolTip" : "Mode",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 25,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#serviceLevel" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#serviceLevel",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Service Level",
                    "displayOrder" : 541,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "servicelevelcode",
                    "suggestionsSource" : "metadata_ToshibaVeractionServiceLevels",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Level",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#transportMode" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#transportMode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Transport Mode",
                    "displayOrder" : 508,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : True,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "transportMode",
                    "suggestionsSource" : "metadata_transportModes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Transport Mode",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : [
                        {
                            "id" : "555b112989025b2b58759f7f",
                            "v" : "Ocean",
                            "n" : "Ocean"
                        }
                    ],
                    "length" : 20,
                    "customFlag" : False
                }
            },
            "templateId": ObjectId("5649d0ce087df204a8a71637"),
            "docType": "shipment",
            "isDefault" : False,
            "systemId": ObjectId("5649d0ce087df204a8a71638"),
            "template" : {
                "ServiceType" : {
                    "profileBased" : True,
                    "key" : "ServiceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Service Type",
                    "isMasterField" : False,
                    "displayOrder" : 588,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_AMATServiceType",
                    "errorMessage" : "",
                    "groupCaption" : "SHIPMENT INFORMATION",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "fpcName" : {
                    "profileBased" : True,
                    "isDocUPload" : None,
                    "key" : "fpcName",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "useForCustomReport" : None,
                    "tariffIdentifier" : None,
                    "isMultiple" : None,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "FPC name",
                    "isMasterField" : None,
                    "displayOrder" : 447,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionsSource" : "metadata_businessUnit",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : None,
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : None,
                    "value" : None,
                    "length" : 10,
                    "customFlag" : None
                },
                "destinationStationCode" : {
                    "profileBased" : True,
                    "key" : "destinationStationCode",
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "label" : "Destination Station Code",
                    "isMasterField" : True,
                    "displayOrder" : 102,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Destination Station Code",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 35,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#serviceType" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#serviceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Service Type",
                    "displayOrder" : 540,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_ToshibaVeractionServiceTypes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "businessUnit" : {
                    "profileBased" : True,
                    "key" : "businessUnit",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "tariffIdentifier" : None,
                    "isMultiple" : None,
                    "regex" : None,
                    "groupKey" : "references",
                    "label" : "Business Unit",
                    "isMasterField" : None,
                    "displayOrder" : 176,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : "businessUnit",
                    "suggestionsSource" : "metadata_TYCOBusinessUnits",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : "Business Unit",
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "value" : None,
                    "length" : 200,
                    "customFlag" : None
                },
                "OriginAirportCode" : {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "fieldValidation" : "",
                    "label" : "Origin Airport Code",
                    "isMasterField" : False,
                    "displayOrder" : 86,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Airport Code",
                    "isDependent" : False,
                    "key" : "OriginAirportCode",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 3,
                    "customFlag" : False
                },
                "serviceType" : {
                    "profileBased" : True,
                    "key" : "serviceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Service Type",
                    "isMasterField" : False,
                    "displayOrder" : 126,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "metadata_serviceTypes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "serviceLevel" : {
                    "profileBased" : True,
                    "key" : "serviceLevel",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Service Level",
                    "isMasterField" : False,
                    "displayOrder" : 127,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "metadata_serviceLevels",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Level",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "originStationCode" : {
                    "profileBased" : True,
                    "key" : "originStationCode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "label" : "Origin Station Code",
                    "isMasterField" : True,
                    "displayOrder" : 79,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Station Code",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 35,
                    "customFlag" : False
                },
                "shipmentType" : {
                    "profileBased" : True,
                    "key" : "shipmentType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Shipment Type",
                    "isMasterField" : False,
                    "displayOrder" : 5,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "shipmentType",
                    "suggestionsSource" : "metadata_shipmentTypes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Shipment Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "billToPartyPartyAccountNumber" : {
                    "profileBased" : True,
                    "key" : "billToPartyPartyAccountNumber",
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "invoice",
                    "label" : "Bill To Account Number",
                    "isMasterField" : True,
                    "displayOrder" : 51,
                    "type" : "text",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "account",
                    "errorMessage" : "",
                    "groupCaption" : "Invoice",
                    "toolTip" : "Bill To Account Number",
                    "isDependent" : False,
                    "isUniqueField" : True,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : None,
                    "length" : 25,
                    "customFlag" : False
                },
                "references#references#businessUnit" : {
                    "profileBased" : True,
                    "key" : "references#references#businessUnit",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "label" : "Business Unit",
                    "displayOrder" : 547,
                    "regex" : None,
                    "groupKey" : "references",
                    "fieldValidation" : "",
                    "tariffIdentifier" : None,
                    "isMasterField" : None,
                    "isMultiple" : None,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : "businessUnit",
                    "suggestionsSource" : "metadata_TYCOBusinessUnits",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : "Business Unit",
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 200,
                    "customFlag" : None
                },
                "mode" : {
                    "profileBased" : True,
                    "key" : "mode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "invoice.delivered",
                    "label" : "Delivery Mode",
                    "isMasterField" : False,
                    "displayOrder" : 262,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "invoiceDeliveryMode",
                    "suggestionsSource" : "metadata_deliveryMode",
                    "errorMessage" : None,
                    "groupCaption" : "Delivery",
                    "toolTip" : "Mode",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 25,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#serviceLevel" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#serviceLevel",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Service Level",
                    "displayOrder" : 541,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "servicelevelcode",
                    "suggestionsSource" : "metadata_ToshibaVeractionServiceLevels",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Service Level",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : None,
                    "length" : 20,
                    "customFlag" : False
                },
                "shipmentInformation#shipmentInformation#transportMode" : {
                    "profileBased" : True,
                    "key" : "shipmentInformation#shipmentInformation#transportMode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Transport Mode",
                    "displayOrder" : 508,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "fieldValidation" : "",
                    "tariffIdentifier" : True,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "transportMode",
                    "suggestionsSource" : "metadata_transportModes",
                    "errorMessage" : "",
                    "groupCaption" : "",
                    "toolTip" : "Transport Mode",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "autoFetchRule" : None,
                    "value" : [
                        {
                            "id" : "555b112989025b2b58759f7f",
                            "v" : "Ocean",
                            "n" : "Ocean"
                        }
                    ],
                    "length" : 20,
                    "customFlag" : False
                }
            },
            "affectAccounts": True,
            "accountId" : parent["_id"],
            "addedBy" : "invoizeAutomation"
    
        }

        fields = []

        for rec in data:
            ocean_field_json={
            "profileBased": False,
            "isDocUPload": True,
            "isReadonly": False,
            "tariffIdentifier": False,
            "useForCustomReport" : True,
            "regex": None,
            "groupKey": rec["Group Key"],
            "label": rec["Data Fields"],
            "displayOrder": rec["Display Order"],
            "type": rec["Field Type"],
            "isDefault": False,
            "validationActive": True,
            "description": None,
            "suggestionsSource": rec["Suggestion Source"],
            "suggestionField": rec["Suggestion field"],
            "errorMessage": "",
            "groupCaption": rec["Group Caption"],
            "toolTip": rec["Data Fields"],
            "isDependent": False,
            "key": rec["Field Key"],
            "addInAccessSet": False,
            "isActive": True,
            "length": rec["Max Length"],
            "customFlag": False
            }
            if rec["Mandatory"]=="Yes":
                ocean_field_json["isMandatory"] = True
            else:
                ocean_field_json["isMandatory"] = False
            if rec["Is Master Field"]=="Yes":
                ocean_field_json["isMasterField"] = True
            else:
                ocean_field_json["isMasterField"] = False

            if rec["Data Fields"] == "View Document":
                ocean_field_json["validationActive"]= False
                ocean_field_json["useForCustomReport"]= None
            if rec["Multiple field"]=="Yes":
                ocean_field_json["isMultiple"] = True
            else:
                ocean_field_json["isMultiple"] = False

            if rec["is Unique Field"]=="Yes":
                ocean_field_json["isUniqueField"] = True
            else:
                ocean_field_json["isUniqueField"] = False

            if rec["Is System unique field"]=="Yes":
                ocean_field_json["isSystemUniqueField"] = True
            else:
                ocean_field_json["isSystemUniqueField"] = False


            fields.append(ocean_field_json)
        oceanShipmentData["profileName"]= acc+" OCEAN"
        oceanShipmentData["fields"] = fields

        #print(oceanShipmentData)
        shipmentcoll.insert_one(oceanShipmentData)
        #print(airShipmentData)
        shipment = shipmentcoll.find_one({"profileName":acc+" OCEAN"},{"_id":1})
        accountColl.update_one({"_id" : parent["_id"]},{
            "$push" : {
            "references.shipmentProfile": shipment["_id"]
            }
        })

    except Exception as err:
        print(err)

def createDocumentProfile(db,acc):
    try:
        documentColl = db["ceva20150519134235Metadata"]
        accountColl = db["Account"]
        data ={
        "profileBase": [
        {
            "profileBased": True,
            "key": "serviceType",
            "isReadonly": False,
            "isMandatory": True,
            "tariffIdentifier": False,
            "isMultiple": False,
            "regex": None,
            "groupKey": "shipmentInformation",
            "label": "Service Type",
            "isMasterField": False,
            "displayOrder": 126,
            "type": "dropdown",
            "isDefault": False,
            "validationActive": True,
            "description": "",
            "suggestionField": "serviceType",
            "suggestionsSource": "metadata_serviceTypes",
            "errorMessage": "",
            "groupCaption": "",
            "toolTip": "Service Type",
            "isDependent": False,
            "isUniqueField": False,
            "addInAccessSet": False,
            "isActive": True,
            "length": 20,
            "customFlag": False
        },
        {
            "profileBased": True,
            "key": "serviceLevel",
            "isReadonly": False,
            "isMandatory": True,
            "tariffIdentifier": False,
            "isMultiple": False,
            "regex": None,
            "groupKey": "shipmentInformation",
            "label": "Service Level",
            "isMasterField": False,
            "displayOrder": 127,
            "type": "dropdown",
            "isDefault": False,
            "validationActive": True,
            "description": "",
            "suggestionField": "servicelevelcode",
            "suggestionsSource": "metadata_serviceLevels",
            "errorMessage": "",
            "groupCaption": "",
            "toolTip": "Service Level",
            "isDependent": False,
            "isUniqueField": False,
            "addInAccessSet": False,
            "isActive": True,
            "length": 20,
            "customFlag": False
        },
        {
            "profileBased": True,
            "key": "transportMode",
            "isReadonly": False,
            "isMandatory": False,
            "tariffIdentifier": True,
            "isMultiple": False,
            "regex": None,
            "groupKey": "shipmentInformation",
            "label": "Transport Mode",
            "isMasterField": False,
            "displayOrder": 6,
            "type": "dropdown",
            "isDefault": False,
            "validationActive": True,
            "description": "",
            "suggestionField": "transportMode",
            "suggestionsSource": "metadata_transportModes",
            "errorMessage": "",
            "groupCaption": "",
            "toolTip": "Transport Mode",
            "isDependent": False,
            "isUniqueField": False,
            "addInAccessSet": False,
            "isActive": True,
            "value" : [
            ],
            "length": 20,
            "customFlag": False
        },
        {
            "profileBased": True,
            "key": "businessUnit",
            "isReadonly": None,
            "isMandatory": None,
            "tariffIdentifier": None,
            "isMultiple": None,
            "regex": None,
            "groupKey": "references",
            "label": "Business Unit",
            "isMasterField": None,
            "displayOrder": 176,
            "type": "dropdown",
            "isDefault": None,
            "validationActive": None,
            "description": None,
            "suggestionField": "businessUnit",
            "suggestionsSource": "metadata_TYCOBusinessUnits",
            "errorMessage": None,
            "groupCaption": None,
            "toolTip": "Business Unit",
            "isDependent": None,
            "isUniqueField": None,
            "addInAccessSet": None,
            "isActive": True,
            "length": 200,
            "customFlag": None
        },
        {
            "profileBased": True,
            "key": "invoiceType",
            "isReadonly": None,
            "isMandatory": None,
            "tariffIdentifier": None,
            "isMultiple": None,
            "regex": None,
            "groupKey": None,
            "label": "Invoice Type",
            "isMasterField": None,
            "displayOrder": 329,
            "type": "dropdown",
            "isDefault": None,
            "validationActive": None,
            "description": None,
            "suggestionField": "chargeType",
            "suggestionsSource": "metadata_chargeType",
            "errorMessage": None,
            "groupCaption": None,
            "toolTip": None,
            "isDependent": None,
            "isUniqueField": None,
            "addInAccessSet": None,
            "isActive": True,
            "length": 100,
            "customFlag": None
        }
        ],
        "details" : {
        "docList" : [
            {
                "id" : "5698bc1b3f26c1083119bca9",
                "isMandatory" : True,
                "name" : "HAWB"
            }
        ]
    },
        "type" : "docProfile",
        "system" : ObjectId("5649d0ce087df204a8a71638")
        }
      

        parent = accountColl.find_one({"accountNumber":acc},{"_id":1,"accountName":1})
        data["details"]["name"] = acc
        data["details"]["value"] = acc
        data["account"] = parent["_id"]
        data["addedBy"] = "invoizeAutomation"

        documentColl.insert_one(data)

        document = documentColl.find_one({"details.name":acc},{"_id":1})
        accountColl.update_one({"_id" : parent["_id"]},{
            "$push" : {
            "references.docProfile": document["_id"]
            }
        })
    except Exception as err:
        print(err)

def createDeliveryProfile(db,acc):
    try:
        deliveryColl = db["ceva20150519134235DeliveryProfiles"]
        accountColl = db["Account"]
        #with open("deliveryProfile.json", "r") as jsonfile:
        #    data = json.loads(jsonfile.read())      

        parent = accountColl.find_one({"accountNumber":acc},{"_id":1,"accountName":1,"accountNumber":1})


        data={
            "chargeType" : None,
            "docType" : "metadata_webDeliveryProfile",
            "nextDeliver" : "",
            "scheduling" : [

            ],
            "query" : {

            },
            "schedulingOnOff" : False,
            "isTemplateDownload" : True,
            "emailPerInvoice" : False,
            "isDefaultEDI" : False,
            "deliveryNumber" : None,
            "shipmentProfileSelected" : "VISTEON MASTER OCEAN",
            "profileReferenceID" : None,
            "deliveryParty" : "fpc",
            "dontUseAdditionalInvoice" : False,
            "type" : "invoiceDeliveryWeb",
            "showUplodedColumn" : False,
            "deliveryPartyName" : "FPC",
            "showApproveColumn" : False,
            "webInvoiceRows" : [
                {
                    "isCustomField" : False,
                    "isUniqueField" : False,
                    "groupKey" : "invoice",
                    "isReadonly" : True,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : False,
                    "label" : "Invoice Number",
                    "updateField" : False,
                    "isMasterField" : True,
                    "isActive" : True,
                    "key" : "invoiceNumber",
                    "addInAccessSet" : False,
                    "parentKey" : None,
                    "displayOrder" : 1.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "details",
                    "isReadonly" : True,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "HBL Number",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : True,
                    "key" : "shipmentNumber",
                    "addInAccessSet" : None,
                    "parentKey" : "shipmentInformation",
                    "displayOrder" : 2.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "details",
                    "isReadonly" : True,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "Booking Number",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : True,
                    "key" : "bookingNumber",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 3.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "invoice",
                    "isReadonly" : True,
                    "type" : "date",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "Invoice Date",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : True,
                    "key" : "invoiceDate",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 4.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "invoice",
                    "isReadonly" : True,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "Amount",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : True,
                    "key" : "invoiceTotal",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 5.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "invoice",
                    "isReadonly" : True,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "Mode",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : True,
                    "key" : "mode",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 6.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "delivered",
                    "isReadonly" : True,
                    "type" : "date",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "Delivery Date",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : True,
                    "key" : "DeliveryDate",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 7.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "invoice",
                    "isReadonly" : False,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "Payment Status",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : True,
                    "key" : "paymentStatus",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 8.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "details",
                    "isReadonly" : False,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "PO Number",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : False,
                    "key" : "poNumber",
                    "addInAccessSet" : None,
                    "parentKey" : "references",
                    "displayOrder" : 9.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "details",
                    "isReadonly" : False,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "RIG Number",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : False,
                    "key" : "rignumber",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 10.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "details",
                    "isReadonly" : False,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "IVR Number",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : False,
                    "key" : "ivrNumber",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 11.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "details",
                    "isReadonly" : False,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "Origin",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : True,
                    "key" : "origincode",
                    "addInAccessSet" : None,
                    "parentKey" : "references",
                    "displayOrder" : 12.0
                },
                {
                    "isCustomField" : False,
                    "isUniqueField" : None,
                    "groupKey" : "details",
                    "isReadonly" : False,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "Destination",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : True,
                    "key" : "destinationcode",
                    "addInAccessSet" : None,
                    "parentKey" : "references",
                    "displayOrder" : 13.0
                },
                {
                    "isCustomField" : True,
                    "isUniqueField" : False,
                    "groupKey" : "delivered",
                    "isReadonly" : False,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : False,
                    "label" : "Approval Status",
                    "updateField" : False,
                    "isMasterField" : True,
                    "isActive" : True,
                    "key" : "approvalStatus",
                    "addInAccessSet" : False,
                    "parentKey" : None,
                    "displayOrder" : 14.0
                },
                {
                    "isCustomField" : True,
                    "isUniqueField" : None,
                    "groupKey" : "delivered",
                    "isReadonly" : False,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "Print Status",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : False,
                    "key" : "printStatus",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 15.0
                },
                {
                    "isCustomField" : True,
                    "isUniqueField" : None,
                    "groupKey" : "delivered",
                    "isReadonly" : False,
                    "type" : "text",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "Upload Status",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : False,
                    "key" : "uploadStatus",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 16.0
                },
                {
                    "isCustomField" : True,
                    "isUniqueField" : None,
                    "groupKey" : "delivered",
                    "isReadonly" : False,
                    "type" : "date",
                    "length" : 100.0,
                    "isMandatory" : None,
                    "label" : "Approval Date",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : True,
                    "key" : "approvalDate",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 17.0
                },
                {
                    "isCustomField" : True,
                    "isUniqueField" : None,
                    "groupKey" : "delivered",
                    "isReadonly" : False,
                    "type" : "text",
                    "length" : "500",
                    "isMandatory" : None,
                    "label" : "Comment",
                    "updateField" : False,
                    "isMasterField" : None,
                    "isActive" : True,
                    "key" : "comment",
                    "addInAccessSet" : None,
                    "parentKey" : None,
                    "displayOrder" : 18.0
                }
            ],
            "makeReadOnly" : False,
            "createdBy" : {

            },
            "addInAccessSet" : None,
            "showPrintColumn" : False,
            "createdOn" : {

            },
            "profileBase" : [
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "label" : "Shipment Type",
                    "displayOrder" : 5.0,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "shipmentType",
                    "suggestionsSource" : "metadata_shipmentTypes",
                    "errorMessage" : "",
                    "groupCaption" : "Shipment Information",
                    "toolTip" : "Shipment Type",
                    "isDependent" : False,
                    "key" : "shipmentType",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : None,
                    "length" : 20.0,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "label" : "Transport Mode",
                    "displayOrder" : 6.0,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "tariffIdentifier" : True,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "transportMode",
                    "suggestionsSource" : "metadata_transportModes",
                    "errorMessage" : "",
                    "groupCaption" : "Shipment Information",
                    "toolTip" : "Transport Mode",
                    "isDependent" : False,
                    "key" : "transportMode",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : [

                    ],
                    "length" : 20.0,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "key" : "billToPartyPartyAccountNumber",
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "label" : "Bill To Account Number",
                    "displayOrder" : 51.0,
                    "regex" : None,
                    "groupKey" : "invoice",
                    "tariffIdentifier" : False,
                    "isMasterField" : True,
                    "isMultiple" : False,
                    "type" : "text",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "account",
                    "errorMessage" : "",
                    "groupCaption" : "Invoice",
                    "toolTip" : "Bill To Account Number",
                    "isDependent" : False,
                    "isUniqueField" : True,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : "",
                    "length" : 25.0,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : False,
                    "label" : "Origin Station Code",
                    "displayOrder" : 79.0,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "tariffIdentifier" : False,
                    "isMasterField" : True,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Station Code",
                    "isDependent" : False,
                    "key" : "originStationCode",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 35.0,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "key" : "OriginAirportCode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "label" : "Origin Airport Code",
                    "displayOrder" : 86.0,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "fieldValidation" : "",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Airport Code",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 3.0,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "label" : "Destination Station Code",
                    "displayOrder" : 102.0,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "tariffIdentifier" : False,
                    "isMasterField" : True,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Destination Station Code",
                    "isDependent" : False,
                    "key" : "destinationStationCode",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 35.0,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "label" : "Service Type",
                    "displayOrder" : 126.0,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_serviceTypes",
                    "errorMessage" : "",
                    "groupCaption" : "Shipment Information",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "key" : "serviceType",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 20.0,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "label" : "Service Level",
                    "displayOrder" : 127.0,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "servicelevelcode",
                    "suggestionsSource" : "metadata_serviceLevels",
                    "errorMessage" : "",
                    "groupCaption" : "Shipment Information",
                    "toolTip" : "Service Level",
                    "isDependent" : False,
                    "key" : "serviceLevel",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 50.0,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : None,
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "useForCustomReport" : True,
                    "label" : "Business Unit",
                    "displayOrder" : 175.0,
                    "regex" : None,
                    "groupKey" : "references",
                    "tariffIdentifier" : None,
                    "isMasterField" : None,
                    "isMultiple" : None,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : "businessUnit",
                    "suggestionsSource" : "metadata_ToshibaBusinessUnits",
                    "errorMessage" : None,
                    "groupCaption" : "References",
                    "toolTip" : "Business Unit",
                    "isDependent" : None,
                    "key" : "businessUnit",
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "value" : "",
                    "length" : 200.0,
                    "customFlag" : None
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "label" : "Delivery Mode",
                    "displayOrder" : 262.0,
                    "regex" : None,
                    "groupKey" : "invoice.delivered",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "invoiceDeliveryMode",
                    "suggestionsSource" : "metadata_deliveryMode",
                    "errorMessage" : None,
                    "groupCaption" : "Delivery",
                    "toolTip" : "Mode",
                    "isDependent" : False,
                    "key" : "mode",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 25.0,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isDocUPload" : None,
                    "isUniqueField" : None,
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "useForCustomReport" : None,
                    "label" : "FPC name",
                    "displayOrder" : 446.0,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "tariffIdentifier" : None,
                    "isMasterField" : None,
                    "isMultiple" : None,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionsSource" : "metadata_businessUnit",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : None,
                    "isDependent" : None,
                    "key" : "fpcName",
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "value" : "",
                    "length" : 10.0,
                    "customFlag" : None
                },
                {
                    "profileBased" : True,
                    "key" : "ServiceType",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "label" : "Service Type",
                    "displayOrder" : 588.0,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_AMATServiceType",
                    "errorMessage" : "",
                    "groupCaption" : "SHIPMENT INFORMATION",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : None,
                    "length" : 20.0,
                    "customFlag" : False
                }
            ],
            "skipAuditDelivery" : True,
            "configurations" : {
                "invoiceTemplate" : "<meta charset=\"UTF-8\">    <title></title><style type=\"text/css\">    body {        font-family: 'open Sans';    }    .weblayout-main {        margin: 0 auto;        width: 90%;        padding: 20px;    }    label {        margin: 0 !important;        line-height: inherit !important;    }    .font-10 {        font-size: 10px;    }    .font-14 {        font-size: 14px;    }    .font-16 {        font-size: 16px;    }    .font-12 {        font-size: 12px;    }    .label-block {        display: block;    }</style><div class=\"weblayout-main\" style=\" border:black 1px solid\"><div>    <div style=\"width:120px;position:relative;display:inline-block;float:left;height:120px;\">        <img src=\"data:image/gif;base64,R0lGODlhhQBFAPcAAAAAAP/////+//7+/qItSiMfICgfIPnv8Pfu7/z09fPm6Pjx8u/Y3PPh5Pfr7fXp6+K/xunM0pwbOZ4rRaAsR6ItSKMuSaQvSqAvSOXFzJkZN5ocO5wdO5wdPZsePpoePZwfPpcePaAhP50gQJ4hQZogPp8iQJ0iP58jQpwkQaEmRKInRKAnRp4nQ58oRKApR6EqRqcsS6QrSqIrR6IrSaMsSqEsSZ8rSKQtSaQtS6UvTaMuS6AtSqEuS6IwS6Y1Uac3UqU3UqQ3UaY4U6k7V65JY7BOZ7BSaQwICcmHmM+Uo9WgrRAMDRIOD+KyvtmrthMPEBQQERUREtyzveG4whYSExcTFBgUFRkVFhoWFxsXGBwYGR0ZGh4aGx8bHCEdHiAcHSIeHyQgIezT2SUhIiYiIy0pKlJOT/r295cTOJoXOZkZOpoaPJ0cPqAfQZweQZ0gQp8iRJohQZ0mRaEpSaItTaQzUaU0Uqg2VKU3VaY5Vqs/XKxEYLNVbrdbc7lker5sgsN6je/c4aImSighIxgPEhUPESQbHhoUFh8ZGyEbHSQeICYjJCglJisoKfbn7Do3ODk2N/To7EI/QHx5eomGh/v4+fbr7xEPEBIQERQSExUTFBYUFRgWFxwaGxsZGh8dHiIgISEfICAeHyQiIyclJjEvMDAuLzQyMz07PEhGR0RCQ1VTVFFPUE1LTGRiY2BeX1xaW1lXWGlnaKqoqamnqKWjpKGfoKCen5aUlZGPkI6MjYF/gP/9/v78/f37/Pv5+uro6efl5uTi4+Hf4N3b3NrY2dnX2NbU1c/NzszKy8vJysrIycnHyLu5urKwsbCur6+trq6sra2rrKyqqxMOEvz5/O3s7cbFxsPCw7++v6emp/z8/nt/gP7///b6+cnPzfv//f3//vn7+r7Av6yurff49/3//P///f39+/z79yQgHR4aGfbs6/36+nFwcPb19fLx8dPS0tDPz83MzLa1tZuamv39/fr6+vn5+d3d3dvb28rKysjIyK6urv///yH5BAEAAP8ALAAAAACFAEUAAAj/AAMIHEiwoMGDCBMSFBDAm0ABDnsFgDgGEAYfSYaZm8iQ4ACBDhWKHEmypMmTCQd488YQIkOWvZ7oaJMDxoY/5LCJEyDuI8qfQIMKHckzgESjIBMkOYFiR48cM0YkqdctGboAH31OHMq1q9eEKwX0aqngDwcXFXYQwNCDBQsn4GJREjYw69e7eLkKgLhTXIQiG3rUWEtA7Q4VBCJcm4XKnrW8kCOf9NaLZUN0MknosJGjB4EcBGRg4HGCCAMB9kCl0nZPq+TXsLHyFaAuSRwVPHr0oFDD6Q4ePGjgAHHkgABkq5DASnY0tvO8ECWWLQEDhwULhStgr/AUB4YcHgD9/woQjxKSLZSIPV//k2V0dFcdevvLgYJnAvjzExhc+DOdEEmcw1A0jABgRi7XFNQRewwqGIA4lGEVADpT2IFCBRfop2F/+eXwQgpLPCiAPK0gwcQktcBTl4QNNsgQfEat5E4SKKQwGgEVbJifWhzm4MILEKiEzgK8cILEFWdo44tAdrXYIDrefNSLAoDIsUJaOfCQo45cYoCCHgww6c00pzRxhRazJMOkkw06NIAAA4xhhAc0pEUAcBRwiR+PPNbQwwhGKEDQMa1A4QUUjFAyjE+MsvnaXuJgNcUdHmCAwQ511JADf1zu4CmPBPRggw8c/AEMQfDwosUVXTRxii4Jrv/pqGRwBoCGEnOoYEEFMtxJAA2/6Qnqnr1hgEMbAS4YwDOnRCEGF1BMQouKs74W6QGAtOGCp4XVUMGlnG7IZ341eHsnHR0soWwAxrDSRBdiWGFFK9pU29WbOzXUkZxt2NBbuHoGXNh9O8zBAhUCocNQL6lmkUUZX1SxxSzyuKaQxfY+xJLCAkyRBwkY9BaqwCTvR6wOc+QxhsJRSgiNKVF8IUYYUjTCi3oSNspixgWJs1Ot7iihgq43ysBDyQL31sMOFXQGQhGCQtrRPqxkAkYZBWyRiSm5xONRQRjbK5ZDAlwCyAcvVKBdDjZwi7SePfQaao47lGpJUZYFgE8ln2T/QUYBBWgRxSTUbCRr2BlD5BADR3RQwdE++LtDDTi8rScPOUzeLQEWtBEIQSEFcE89MH+xiBhkZLEJK9qsi3jiVAzxQeW/cUZDlpYLi5+md2JOAQhKIDQAMbJAwcXfYoBRhSezIJMzzwah84sSLKCAQ6881KCDWkfn3ulnd2o6GAUuDDIFlB1pFU8lXGQhhhiAhwGFzcPICr1ACwQCggueMd1Zsfupg/d0lIMb7M43O8BBCuwQga1YzBv1QAUUvvC3ApABWqjoWote4hNvhGMvlxHEETYgg6fsboAoxBFodgACPjQAXyDZi0SIhwkvVPB9WZDCJKBBLec4RBzhYNJe/1ZyFXFAQA8j6AEPdnAD7qUwhZ7BQQn8kIB8QURfDUED364AOPjBDwudkEU2SPK6k4xFIix5U8KUQIcTxCA0wAENaJ6Yu8GoBQMV6EAgKAOfIUYqK86QYBgAV4D3fUEKXpiFMRgyAMQ1UiiRUpyyxJG/ErTAT56hQQ1uZwM65k4tg/EOHTygBJbJxiDEgEUTbDjIQhYADDXjBV20UkaU/CyIDQlAEAXhBw7MYHe52ZRg7uNJpKVFfJ1hgQqm4JJz5E10AoEH+7Dwvi5aEFqRyEUPd1ZLkcDJTVsRAASIwAYflOtSm+qPyIqJNBzsQHJLzEELdBABh6BDJTuTkDMi0f+EQsJPFBYsABYysYpnnGpFeqHMXgQAnyXQwAQYaFuOahDP282RnW9b4WB4gIEUuPAqtUKoQIgRiyjYkAzwI6RAryALbDQnnz/hiUvQcYBAjIAFeHwc50C1NIy+jaL7wVxvPLUBPxgnJQ5Bwy7AYAX4hcKVhQxDzN5hjIWc5E29yJeEvCGIPkigiePyqVjvyAFA3MMbUMrlXtTIJG1EAgphAKhK4deFKDSiEvUTKUJW4jOJfGRsAsjAHkAgKg6J9bA86JUUlSCg9D1IpKk0VEoDCjgy1DUS9vCa/RByxQl5w2cMWQIBQKCDi+pnWId94uQG4wIUPIElEdpJ6NZkCV3/eKGpKRWDXOF3BSmooh752CxnWzKR/I1gBUu0U2pTOxjPVAAFdcgAaPWlM4JoAxJQcOVkJ2uFK8QCGyOhzEdCogA/bABYPVAbalG73BTqlGko2IMgXBJDvQZgGLDABLy8mNswkEGqYrAHTAeiVSEJtg2TA46m1tteT2ppopzjQB/aAaGUsOgXuhiFFVRKyJSSQQuZsMe6BtJZb5xjCTkwgQ5ogMcdNVis/LlAJwkwgzYAwh1i2Yr9aBmAbKQiCv6EKiE/zAh5KIQnSiFBC3AELpOx98VP5EGmvpUDYGEAWRCC4dcMMoxXRGELk+WwGJrwDveEJFIKC0AD/rAGGDTY/207CitG5fyCODzhiiM2yEfwkYsCXOGGBXhqIbuAioZ8NiQLywAfOqAW0wYMzoV5ssDWK+kBQhoDLchBBj5yFTIGQBupaEIYZpZbV8KJkRBRmExSYIEcOFpDhqn0oz912uUOC1QdBZOORaIVYbwiE34LMiEfi8YhBUIOKfgRHV4wgRc4+9nPXrazWQDtalO72tPGtra3ze1ua3sFdKDDBDgANZR85Be5EMMVvNhhfa3EGw4AxAuEgIc84CEIQwBCEPbNb34Pod/4HsK/Aw7wguPb3wIXeL8HbvCGG1zhCAfCEH4wBCG0IBCWuNiAA4CNVEABDO+rJki2sgBBKEASKP+XxCNWnvKWu/zlMI+5zGdO85q/XAEPULkCGvAY4fk8AIuJwvG6KMmiTAhO8IlP0pcOn3Mw/elQj7rUnS71qls96bkkcad/vtl7CCAf9vCzqeUzAHyMIx/5+EY+rIH2fACj7XDPhznygbF74APtd4873Ocud3xg7Bf4yMsvxpOwvcDIGgc9SHX1io1JMAHkDrHEM97Rispb/vKYx7wr3kEXgehjF7A4wxksP/rMX/4MrHhHPfwuEGS8ohX18MpVkAELVsTe8AGwBgQC4Yc+AOIJCUBrpyNlkmDMQhOfGEAwXmEFKFzhClh4vvSnT/3nY6EKSHiHQEjHhCh0N/rVpz7/FqwwfihwYhZeg4crTCSKei3ewmsSwDBSYaJGOG8ivkjCHD4wghSU4A1/8ACXMWK11Av2EArmEAtI4AVlIAaLsAgcFoERKAZM4AoCgA0Rg1K5FWYS2EXJgwSzIADE0AVdwAhXgArHYBKukRXxIAtMEAqHAAX+0BJKwAYswAMXoAM4MAEa8AdowFBbhxL8YAsTRAZbUAVX0F3ht4S9BQrUIACqUAWEoG5SIH1KuIRKiEhi4AWc8AwC8Ar9JAa+NUsbt2UE8Q5NIArxkgrCACFPcAIw4Ckn4AEzYAEY4AGBICTC5XNZcQbrtgWQYA/RIA2EWIiGeIiEOA3UMA8B0Axd/xAGYcAFszCIiFiJ0jANz5ALqOAFY/YKAhAMqwAFf4MJsJB4ZQhTuiAFp8MFBZANDJEBdXBJMIACgaAEOaACPjAcSxAlKjFbvCYQjPAFYbAFsXeKImELmhAGWbAK1+ATeaZnAbANm6Buq+A18mAGD1MAmMALjqVxEwENWuAFBsAOnbANEyIIRABdBLABgdBQKHCDLnAwfrUS3VQXo8YFZUAP9XgQDoELVxAGVRALL1VLPuEMXHQFk6BZzgAGXJA8nIALz6h4zVAKWRAKYGAIlbAT7dAHIIA5HfAHwbcSSfAGa4ECeBABY4FPJXEPAfA++LgMxvhzt/CP3sVIwrAP+v+Qkzq5kzpJDMnQCn4TBayQD5FigIj0YaDgDJ5GDJBgBQ2ICbMgEWgACBtQBxZQAkXwCKcmOoDAARagAyXABwrgVwSmcQNAV2QAk0OBC1gQBlYgCwKhC41QBo1Ql3Z5l3cZBlowirnAIgJACdmVOmZgZL4oIS5xDe7yVFFwBpqVBB9AB/L0A2NQeBCxAH1QAgRQB6WyADwBUkGYEIBzPMrAFWzplnC5D30TBmCwmqzZmqv5BWBAQWHQBMzoGmgAC0AmBlWwCnmFUFLyC+8QBaMgBlEACeohAE9AAnSwAz+SAQ9RGUknCHtwAhVgAxwQCCD0biQxaGlJmm35lgFwDJ7/YAVdsAXmeZ7ouQVccJ5X0ASRMA86o3yq4CwUGAs91CgfUQlwRQpaQAj9ABEZYAMpsAMvAAJPkAF/kKAK+geAMAYRwAO4eAMesAQgZRLwczwwuY8H4Y+mKRCV4AiOYAYhagYkWqImSqKpwAt5hTHIYAruUwBQQAncNBC0gAieQAaKoAXlwBBjoAcmYAEy4AFJMAaDwAYmQAInkAInAAcaoAcKMAUs4AIY4AJzwEyFmRAX2p1ryUVv2Rr4QAzHYAzHMKZkWqZhGqbBAI3WBQrwckgCBjbYwAhaIAaKAAW60BAPYAQjkAM+8JECsARpgAG/VAMUQAE4sAIckAHeoAQb/1CHC4SSV3oQhYSPoxmTCcGhXdoyQfFIeoYLnAAGBcAFXlCMA1EMkXAFobAImPAOv+ANUykBFlAHJWAEDhAAgoAHa1ACIFACcPAGcqAGffAAApAOgcAGGHABIuBCJgE4XVAGlSoUmBoLj+VpTVJdrsELmVBIWWAG8PkR1+AKUYBSmcAKXoMOSVApOxAHQxAmi7ME7vqu7toAaOULllkC3uEBfsCZJDFqXtAFYzQUt2AFYYAk5hCpiqemCPELs9AEZEAIVZAK6gEMs8AEgVYIqVA/3rAEbnADPtACMAABHWEZ+YJW58ARV4EODcAHpEUD18mSI7EKe5kFrZAN9KAMy/9wszibszp7s8xAF9qwBao5CrswD8rAD8pwtDubtDjLD/PAeggRD+AKP0LZDJRQBV+wDlpgBvSwFxDwAirQAzAAIhPxmSIxHzrQAj1AA6TEMmRzELpAsR/GiWQwt3Rbt3Y7t2UQBpDQD2gACX7zBX5TBnh7t4Rbt+/zDmiAON5gDKhgBX+jBV2ABYXkBVzghd7AAHpgIxSALGJyEgzxBCrAP601BUghG74YDI73Pv3KBazbuq77uq3bBUjACgFAC8YjBqPwul0Au7zbuomQBU0Qe46kDQKFNV7gX1xQDbmQVkmwBj5gAR9wY2qFEnuhBHRiARzgB+kgNdNKEPKQCkyXwIqj1oEdqIZMEAtRsgs5BHLjy4Hkq1JdsAlKKVw+QQ2hMEHwYwVSUAn40BE1WANv0AcIcE9jixJXwQ3FugNrAAjOhE/PRBDCwAuQUADj+74cJgpdMAnzEBHaEAuOAHLxU0EWrFJhQAkvBTYD0Qyw4AhfQAquEA3cICIDsACAgAJGwADoULIJgxI6nACA0AJHgMMENmIBAQA7\" data-filename=\"CEVA_Logo.gif\" style=\"width: 133px;\">    </div>    <div style=\"text-align:right;width:300px;position:relative;display:inline-block;float:right;height:120px\">        <label class=\"font-14\"><strong>{{details.addressLine1}}</strong></label>        <label class=\"font-10 label-block\">{{details.addressLine2}}</label>        <label class=\"font-10 label-block\">{{details.addressLine3}}</label>        <label class=\"font-10 label-block\">{{details.addressLine4}}</label>        <label class=\"font-10 label-block\">{{details.addressLine5}}</label>        <label class=\"font-10 label-block\">{{details.addressLine6}}</label>        <label class=\"font-10 label-block\">TEL: {{details.addressLine7}}</label>        <label class=\"font-10 label-block\">FAX: {{details.addressLine8}}</label>    </div>    <!--<div style=\"text-align:center;width:100px;position:relative;display:inline-block;float:right;height:50px;border:black 1px solid\">-->    <!--<label style=\"font-size: 37px\">E115</label>-->    <!--</div>--></div><div style=\"clear:both;border:3px solid #ccc;\"></div><div style=\"float:left;width:40%;display:inline-block\">    <div style=\"float:left;width:60%;display:inline-block\">        <label class=\"font-16 \"><strong>ORIGINAL INVOICE</strong></label>        <div style=\"clear:both;height:25px\"></div>        <label class=\"font-10 \">INVOICE TO</label>        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-12 label-block\">{{invoice.billToPartyPartyAccountNumber}}</label>        <label class=\"font-12 label-block\"><strong>{{invoice.billToPartyPartyName}}</strong></label>        <label class=\"font-12 label-block\">{{invoice.billToPartyAddress1}}</label>        <label class=\"font-12 label-block\">{{invoice.billToPartyCity}}  {{invoice.billToPartyZipCode}}</label>        <label class=\"font-12 label-block\">{{invoice.billToPartyCountry}}</label>    </div></div><div style=\"float:right;width:60%;display:inline-block\">    <div style=\"float:left;width:45%;display:inline-block\">        <label class=\"font-10 label-block\">INVOICE NUMBER</label>        <label class=\"font-14 \"><strong>{{invoice.invoiceNumber}}</strong></label>        <div style=\"clear:both;height:10px\"></div>        <label class=\"font-10 label-block\">SHIPPER NAME</label>        <label class=\"font-10 label-block\">{{details.shipperName}}</label>        <label class=\"font-10 label-block\">{{details.shipperAddress1}}</label>        <label class=\"font-10 label-block\">{{details.shipperCity}}{{details.shipperStateCode}}{{details.shipperZipCode}}</label>        <label class=\"font-10 label-block\">{{details.shipperCountryCode}}</label>        <label class=\"font-10 label-block\">{{details.customerReferenceNumber}}</label>        <div style=\"clear:both;height:10px\"></div>        <div style=\"clear:both;height:10px\"></div>        <label class=\"font-10 label-block\">CONSIGNEE NAME</label>        <label class=\"font-10 label-block\"> {{details.consigneeName}}</label>        <label class=\"font-10 label-block\">{{details.consigneeAddress1}}</label>        <label class=\"font-10 label-block\">{{details.consigneeCity}} {{details.consigneeStateCode}} {{details.consigneeZipCode}}</label>        <label class=\"font-10 label-block\">{{details.consigneeCountryCode}}</label>    </div>    <div style=\"float:right;width:50%;display:inline-block\">        <label class=\"font-10 label-block\">INVOICE DATE</label>        <label class=\"font-14 \"><strong>[formatDate[{{invoice.invoiceDate}}]]</strong></label>        <div style=\"clear:both;height:10px\"></div>        <label class=\"font-10 label-block\">CEVA REF</label>        <label class=\"font-10 label-block\"><strong>{{details.bookingNumber}}/ &nbsp;{{details.dossierNumber}} </strong></label>        <div style=\"clear:both;height:40px\"></div>        <!--<label class=\"font-10 label-block\">ORIGINAL INVOICE NUMBER</label>-->        <!--<label class=\"font-10 label-block\"><strong>{{invoice.invoiceNumber}}</strong></label>-->        <div style=\"clear:both;height:40px\"></div>        <label class=\"font-10 label-block\">CEVA SERVICES</label>        <label class=\"font-10 label-block\">*{{details.serviceLevel}}* </label>    </div></div><div style=\"clear:both;height:20px\"></div><div style=\"clear:both;border:3px solid #ccc;\"></div><div style=\"float:left;width:50%;display:inline-block\">    <div style=\"float:left;width:50%;display:inline-block\">        <label class=\"font-10 label-block\"> HAWB / HBL</label>        <label class=\"font-12 label-block\"> {{details.shipmentNumber}} &nbsp;</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> CARRIER / VESSEL</label>        <label class=\"font-12 label-block\"> {{details.airlineNameVesselName}} &nbsp;</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> PIECES</label>        <label class=\"font-12 label-block\"> {{details.PiecesQuantity}} &nbsp;</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> DESCRIPTION OF GOODS</label>        <label class=\"font-12 label-block\"> {{details.goodsAndItemsGoodsDescription}} &nbsp;</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> RIG #</label>        <label class=\"font-12 label-block\"> {{details.rignumber}} &nbsp;</label>    </div>    <div style=\"float:right;width:50%;display:inline-block\">        <label class=\"font-10 label-block\"> MAWB / MBL</label>        <label class=\"font-12 label-block\"> {{details.masterShipmentNumber}} &nbsp;</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> FLIGHT / VOYAGE</label>        <label class=\"font-12 label-block\"> {{details.voyagenumber}} &nbsp;</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> ACTUAL WEIGHT</label>        <label class=\"font-12 label-block\">{{details.actualWeight}} &nbsp; KG</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> CIPL REF #</label>        <label class=\"font-12 label-block\">{{details.commercialIvoiceNumber}} &nbsp;</label>        <!--<div style=\"clear:both;height:5px\"></div>-->        <!--<label class=\"font-10 label-block\">No. of MR</label>-->        <!--<label class=\"font-12 label-block\">{{details.numberofmr}} &nbsp;</label>-->    </div></div><div style=\"float:right;width:50%;display:inline-block\">    <div style=\"float:left;width:50%;display:inline-block\">        <label class=\"font-10 label-block\"> DEPARTURE DATE </label>        <label class=\"font-12 label-block\">  {{details.shipmentDate}} &nbsp; </label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> ORIGIN AIRPORT / PORT</label>        <label class=\"font-12 label-block\">  {{details.originStationCode}} &nbsp;</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> CHARGEABLE WEIGHT</label>        <label class=\"font-12 label-block\">  {{details.chargeableWeight}} &nbsp; KG</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> ROE</label>        <label class=\"font-12 label-block\">{{details.ExchangeRate}} &nbsp;</label>        <!--<div style=\"clear:both;height:5px\"></div>-->        <!--<label class=\"font-10 label-block\"> PACKING LIST #</label>-->        <!--<label class=\"font-12 label-block\">{{details.packinglist}} &nbsp;</label>-->    </div>    <div style=\"float:right;width:50%;display:inline-block\">        <label class=\"font-10 label-block\"> ARRIVAL DATE</label>        <label class=\"font-12 label-block\"> {{details.dueDate}} &nbsp;</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> DESTINATION AIRPORT / PORT</label>        <label class=\"font-12 label-block\"> {{details.destinationStationCode}} &nbsp;</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> VOLUME</label>        <label class=\"font-12 label-block\"> {{details.cbm}} &nbsp;</label>        <!--<label class=\"font-10 label-block\">&nbsp;</label>-->        <div style=\"clear:both;height:5px\"></div>        <label class=\"font-10 label-block\"> PO NUMBER</label>        <label class=\"font-12 label-block\">{{details.poNumber}} &nbsp;</label>        <!--<div style=\"clear:both;height:5px\"></div>-->        <!--<label class=\"font-10 label-block\"> COMMENT</label>-->        <!--<label class=\"font-12 label-block\">{{details.Comment}} &nbsp;</label>-->    </div></div><div style=\"clear:both;height:10px\"></div><label class=\"font-14 label-block\">REMARKS: {{details.remarksAndNotesText}} </label><label class=\"font-14 label-block\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{{details.quotenumber}} </label><div style=\"clear:both;height:5px\"></div><div style=\"clear:both;border:3px solid #ccc;\"></div><div style=\"clear:both;height:5px\"></div><div style=\"float:left;width:70%;display:inline-block\">    <div style=\"float:left;width:60%;display:inline-block\">        <label class=\"font-10 label-block\">DESCRIPTION OF CHARGES</label>    </div>    <div style=\"float:right;width:40%;display:inline-block\">        <label class=\"font-10 label-block\">Currency</label>    </div></div><div style=\"float:right;width:30%;display:inline-block\">    <div style=\"float:left;width:30%;display:inline-block;text-align:right;\">        <label class=\"font-10 label-block\">Invoice Amount</label>    </div>    <div style=\"float:right;width:50%;display:inline-block;text-align:right;\">        <label class=\"font-10 label-block\">Tax Code</label>    </div></div><div style=\"clear:both;height:5px\"></div><div style=\"clear:both;border:1px solid #ccc;\"></div><div style=\"clear:both;height:15px\"></div><div style=\"float:left;width:70%;display:inline-block\">    {% for invoiceCharge in invoiceCharges %}    <div style=\"float:left;width:60%;display:inline-block\">        <label class=\"font-12 label-block\">{{invoiceCharge.chargeText}} </label>        <div style=\"clear:both;height:10px\"></div>    </div>    <div style=\"float:right;width:40%;display:inline-block\">        <label class=\"font-12 label-block\">USD</label>        <div style=\"clear:both;height:10px\"></div>    </div>    {% endfor %}</div><div style=\"float:right;width:30%;display:inline-block\">    {% for invoiceCharge in invoiceCharges %}    <div style=\"float:left;width:30%;display:inline-block;text-align:right;\">        <label class=\"font-12 label-block\">{{invoiceCharge.invoiceValue}}</label>        <div style=\"clear:both;height:10px\"></div>    </div>    <div style=\"float:right;width:50%;display:inline-block;text-align:right;\">        <label class=\"font-12 label-block\">00</label>        <div style=\"clear:both;height:10px\"></div>    </div>    {% endfor %}</div><div style=\"clear:both;height:50px\"></div><div style=\"clear:both;border:2px solid #ccc;\"></div><div style=\"clear:both;height:5px\"></div><div style=\"float:left;width:70%;display:inline-block\">    <div style=\"float:left;width:50%;display:inline-block\">        <label class=\"font-14 label-block\"><strong>PAYMENT DUE:&nbsp;&nbsp;[formatDate[{{invoice.paymentDueDate}}]] </strong></label>  </div>    <div style=\"float:right;width:50%;display:inline-block\">        <label class=\"font-14 label-block\"><strong>TOTAL INVOICE</strong></label>    </div></div><div style=\"float:right;width:30%;display:inline-block\">    <div style=\"float:left;width:50%;display:inline-block;text-align:center;\">        <label class=\"font-14 label-block\"><strong>{{invoice.invoiceTotal}}</strong></label>    </div>    <div style=\"float:right;width:50%;display:inline-block;text-align:right;\">        <label class=\"font-14 label-block\"><strong>USD</strong></label>    </div></div><div style=\"clear:both;height:30px\"></div><div style=\"float:left;width:50%;display:inline-block\">    <div style=\"float:left;width:80%;display:inline-block\">        <label class=\"font-10 label-block\"><strong>USD payments please remit to:</strong></label>        <label class=\"font-10 label-block\">Checks: CEVA FREIGHT LLC</label>        <label class=\"font-10 label-block\">Dept 2309</label>        <label class=\"font-10 label-block\"> CAROL Stream, IL 60132-2309</label>        <label class=\"font-10 label-block\">NAME: CEVA</label>        <label class=\"font-10 label-block\">ACCT#: 30853573</label>        <label class=\"font-10 label-block\">ABA#: 021000089</label>        <label class=\"font-10 label-block\">BANK: CITIBANK NY</label>        <div style=\"clear:both;height:10px\"></div>        <label class=\"font-10 label-block \" style=\"text-transform:none;\">For a complete list of CEVA / EGL terms and            conditions ,please go to www.cevalogistics.com/terms.htm</label>    </div>    <div style=\"float:left;width:20%;display:inline-block\">        <div style=\"clear:both;height:130px\"></div>        <label class=\"font-10 label-block \" style=\"text-transform:none;\">Issued By:</label>        <label class=\"font-12 label-block\" style=\"text-transform:none;\"><strong>{{invoice.capturedBy}}</strong></label>    </div></div><div style=\"float:right;width:10%;display:inline-block\">    <div style=\"clear:both;height:130px\"></div>    <label class=\"font-10 label-block \" style=\"text-transform:none;\">Page 1 OF 1</label></div><div style=\"clear:both;height:30px\"></div></div>"
            },
            "accountName" : parent["accountName"],
            "accountNumber" : parent["accountNumber"],
            "profileName" : acc,
            "account" : parent["_id"],
            "details" : {
                "date" : "%m/%d/%Y",
                "profileName" : acc
            },
            "system" : ObjectId("5649d0ce087df204a8a71638"),
            "templateId" : ObjectId("53ea01577fa6420aed51a878"),
            "addedBy" : "invoizeAutomation"
        }
        




        deliveryColl.insert_one(data)

        delivery = deliveryColl.find_one({"accountNumber":acc},{"_id":1})
        accountColl.update_one({"_id" : parent["_id"]},{
            "$push" : {
            "references.deliveryProfile": delivery["_id"]
            }
        })
    except Exception as err:
        print(err)


def createChargeProfile(db,acc):
    try:
        accountColl = db["Account"]
        #with open("chargeProfile.json", 'r') as jsonfile:
        #    chargeProfile = json.loads(jsonfile.read())

        chargeProfile = {
            "templateId" : ObjectId("555b112889025b2b58759c57"),
            "systemId" : ObjectId("5649d0ce087df204a8a71638"),
            "profileBase" : [
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "label" : "Shipment Type",
                    "displayOrder" : 5,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "shipmentType",
                    "suggestionsSource" : "metadata_shipmentTypes",
                    "errorMessage" : "",
                    "groupCaption" : "Shipment Information",
                    "toolTip" : "Shipment Type",
                    "isDependent" : False,
                    "key" : "shipmentType",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 20,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isDocUPload" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "label" : "Transport Mode",
                    "displayOrder" : 6,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "tariffIdentifier" : True,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "transportMode",
                    "suggestionsSource" : "metadata_transportModes",
                    "errorMessage" : "",
                    "groupCaption" : "Shipment Information",
                    "toolTip" : "Transport Mode",
                    "isDependent" : False,
                    "key" : "transportMode",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : [

                    ],
                    "length" : 20,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "key" : "billToPartyPartyAccountNumber",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "label" : "Bill To Account Number",
                    "displayOrder" : 51,
                    "regex" : None,
                    "groupKey" : "invoice",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "account",
                    "errorMessage" : "",
                    "groupCaption" : None,
                    "toolTip" : "Bill To Account Number",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : "",
                    "length" : 25,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "label" : "Origin Station Code",
                    "displayOrder" : 79,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "tariffIdentifier" : False,
                    "isMasterField" : True,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Station Code",
                    "isDependent" : False,
                    "key" : "originStationCode",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 35,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "key" : "originAirportCode",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "label" : "Origin Airport Code",
                    "displayOrder" : 86,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "fieldValidation" : "",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Airport Code",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 3,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "label" : "Destination Station Code",
                    "displayOrder" : 102,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "tariffIdentifier" : False,
                    "isMasterField" : True,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Destination Station Code",
                    "isDependent" : False,
                    "key" : "destinationStationCode",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 35,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "label" : "Service Type",
                    "displayOrder" : 126,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_serviceTypes",
                    "errorMessage" : "",
                    "groupCaption" : "Shipment Information",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "key" : "serviceType",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 20,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "useForCustomReport" : True,
                    "label" : "Service Level",
                    "displayOrder" : 127,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "servicelevelcode",
                    "suggestionsSource" : "metadata_serviceLevels",
                    "errorMessage" : "",
                    "groupCaption" : "Shipment Information",
                    "toolTip" : "Service Level",
                    "isDependent" : False,
                    "key" : "serviceLevel",
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 20,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : None,
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "useForCustomReport" : True,
                    "label" : "Business Unit",
                    "displayOrder" : 175,
                    "regex" : None,
                    "groupKey" : "references",
                    "tariffIdentifier" : False,
                    "isMasterField" : None,
                    "isMultiple" : None,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : "businessUnit",
                    "suggestionsSource" : "metadata_TYCOBusinessUnits",
                    "errorMessage" : None,
                    "groupCaption" : "References",
                    "toolTip" : "Business Unit",
                    "isDependent" : None,
                    "key" : "businessUnit",
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "value" : "",
                    "length" : 200,
                    "customFlag" : None
                },
                {
                    "profileBased" : True,
                    "key" : "filingStationCountry",
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "label" : "Filling Station Country",
                    "displayOrder" : 219,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "tariffIdentifier" : False,
                    "isMasterField" : False,
                    "isMultiple" : False,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionsSource" : "metadata_country",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Filling Station Country",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : "",
                    "length" : 35,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : None,
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "useForCustomReport" : True,
                    "label" : "Invoice Type",
                    "displayOrder" : 328,
                    "regex" : None,
                    "groupKey" : "invoice",
                    "tariffIdentifier" : None,
                    "isMasterField" : None,
                    "isMultiple" : None,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : "chargeType",
                    "suggestionsSource" : "metadata_chargeType",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : None,
                    "isDependent" : None,
                    "key" : "invoiceType",
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "value" : "",
                    "length" : 100,
                    "customFlag" : None
                },
                {
                    "profileBased" : True,
                    "key" : "ServiceType",
                    "isReadonly" : False,
                    "isMandatory" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "label" : "Service TypeAMAT",
                    "isMasterField" : False,
                    "displayOrder" : 480,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "serviceType",
                    "suggestionsSource" : "metadata_AMATServiceType",
                    "errorMessage" : "",
                    "groupCaption" : "SHIPMENT INFORMATION",
                    "toolTip" : "Service Type",
                    "isDependent" : False,
                    "isUniqueField" : False,
                    "addInAccessSet" : False,
                    "isActive" : True,
                    "value" : "",
                    "length" : 20,
                    "customFlag" : False
                },
                {
                    "profileBased" : True,
                    "key" : "fpcName",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "label" : "FPC name",
                    "displayOrder" : 576,
                    "regex" : None,
                    "groupKey" : "shipmentInformation",
                    "tariffIdentifier" : None,
                    "isMasterField" : None,
                    "isMultiple" : None,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionsSource" : "metadata_businessUnit",
                    "errorMessage" : None,
                    "groupCaption" : None,
                    "toolTip" : None,
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "value" : [
                    ],
                    "length" : 30,
                    "customFlag" : None
                },
                {
                    "profileBased" : True,
                    "isDocUPload" : None,
                    "key" : "creditNoteAllowed",
                    "isReadonly" : None,
                    "isMandatory" : None,
                    "useForCustomReport" : None,
                    "label" : "Credit Note Identifier",
                    "displayOrder" : 738,
                    "regex" : None,
                    "groupKey" : "invoice",
                    "tariffIdentifier" : None,
                    "isMasterField" : None,
                    "isMultiple" : None,
                    "isSystemUniqueField" : None,
                    "type" : "dropdown",
                    "isDefault" : None,
                    "validationActive" : None,
                    "description" : None,
                    "suggestionField" : None,
                    "suggestionsSource" : "metadata_TrueFalse",
                    "errorMessage" : None,
                    "groupCaption" : "Invoice",
                    "toolTip" : None,
                    "isDependent" : None,
                    "isUniqueField" : None,
                    "addInAccessSet" : None,
                    "isActive" : True,
                    "value" : "",
                    "length" : 20,
                    "customFlag" : None
                },
                {
                    "profileBased" : True,
                    "isUniqueField" : False,
                    "isReadonly" : False,
                    "isMandatory" : False,
                    "useForCustomReport" : True,
                    "tariffIdentifier" : False,
                    "isMultiple" : False,
                    "regex" : None,
                    "groupKey" : "stationType",
                    "fieldValidation" : "",
                    "label" : "Origin Airport Code",
                    "isMasterField" : False,
                    "displayOrder" : 764,
                    "type" : "dropdown",
                    "isDefault" : False,
                    "validationActive" : True,
                    "description" : "",
                    "suggestionField" : "iataCode",
                    "suggestionsSource" : "metadata_airportCode",
                    "errorMessage" : "",
                    "groupCaption" : "Station Type",
                    "toolTip" : "Origin Airport Code",
                    "isDependent" : False,
                    "key" : "OriginAirportCode",
                    "addInAccessSet" : False,
                    "isActive" : False,
                    "value" : "",
                    "length" : 3,
                    "customFlag" : False
                }
            ]
        }
        charges = []
        #df = pd.read_excel('Automation.xlsx',sheet_name='Charge Profile')
        df = pd.read_csv('ChargeProfile.csv')
        data = df.to_json(orient='records')
        data2=json.loads(data)
        collection_inf = db["ceva20150519134235ChargeProfiles"]
        metadata = db["ceva20150519134235Metadata"]
        for item in data2:
            sample_data = {}
            _id = metadata.find_one({"details.chargeLine" : item['Charge Code'],"details.isActive" : True, "system" : ObjectId("5649d0ce087df204a8a71638")},{"_id":1})
            if item['Charge Code']:
                sample_data['chargeLine'] = item['Charge Code']
            else:
                sample_data['chargeLine'] = ""

            sample_data['rateTariff'] = None
            sample_data['chargeText'] = item['Charge Description']
            sample_data['id'] = str(_id)
            if item['Display Order']:
                sample_data['displayOrder'] = item['Display Order']
            else:
                sample_data['displayOrder'] = ""

            sample_data['rateID'] = None
            if item['Display Order']:
                sample_data['currencyCode'] = item['Default Currency']
            else:
                sample_data['currencyCode'] = ""

            sample_data['system'] = "5649d0ce087df204a8a71638"

            if item['OFS Charge Code']:
                sample_data['ofsChargeCode'] = item['OFS Charge Code']
            else:
                sample_data['ofsChargeCode'] = ""

            sample_data['select'] = True
            sample_data['chargeCode'] = ""

            if item['Charge Description']:
                sample_data['chargeCodeDescription'] = item['Charge Description']
            else :
                sample_data['chargeCodeDescription'] = ""
            if item['Charge Type']:
                sample_data['chargeType'] = item['Charge Type']
            else:
                sample_data['chargeType'] = ""

            sample_data['turnoverGroup'] = None
            sample_data['chargeLevel'] = None
            sample_data['isActive'] = True
            sample_data['racp'] = None
            sample_data['country'] = None
            sample_data['value'] = ""
            sample_data['serviceCode'] = None
            sample_data['templateId'] = "555b112889025b2b58759c57"
            sample_data['ediCode'] = None
            if item['Invoice Text 1']:
                sample_data['invoiceText1'] = item['Invoice Text 1']
            else :
                    sample_data['invoiceText1'] = ""
            if item['Invoice Test 2']:
                sample_data['invoiceText2'] = item['Invoice Test 2']
            else:
                sample_data['invoiceText2'] = ""
            sample_data['paymentTerm'] = None
            
            charges.append(sample_data)

        parent = accountColl.find_one({"accountNumber":acc},{"_id":1})
        chargeProfile["charges"] = charges
        chargeProfile["addedBy"] = "invoizeAutomation"
        chargeProfile["profileName"] = acc
        chargeProfile["accountId"] = parent["_id"]
        collection_inf.insert_one(chargeProfile)

        delivery = collection_inf.find_one({"profileName":acc},{"_id":1})
        accountColl.update_one({"_id" : parent["_id"]},{
            "$push" : {
            "references.chargeProfile": delivery["_id"]
            }
        })
    except Exception as err:
        print(err)

def main():
    #connectionString = 'mongodb://mongo_invoize_uat_dev:eqedT%24FszV1es%40Qo0w8%26C9V@127.0.0.1:44719/?authSource=invoize-uat&readPreference=primary&appname=MongoDB%20Compass&ssl=false'
    #connectionString = 'mongodb://mongo_invoize_uat_dev:eqedT%24FszV1es%40Qo0w8%26C9V@localhost:44719/invoize-uat?serverSelectionTimeoutMS=5000&connectTimeoutMS=10000&authSource=invoize-uat&authMechanism=SCRAM-SHA-1&3t.uriVersion=3&3t.connection.name=UAT&3t.databases=invoize-uat&3t.alwaysShowAuthDB=true&3t.alwaysShowDBFromUserRole=true'
    connectionString = 'mongodb://localhost:27017'
    db = db_connection(connectionString)
    

    for acc in parentAccount:
        print(acc)
        createAirProfile(db,acc)
        createOceanProfile(db,acc)
        createDocumentProfile(db,acc)
        createDeliveryProfile(db,acc)
        createChargeProfile(db,acc)

main()

